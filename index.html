<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VitaCard 365</title>
    <!-- build-stamp: inserted by Copilot on 2025-10-10 -->
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#0d2041" />
  </head>
  <body style="background:#0d2041;">
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  <script type="module" id="ios-splash-intro">
    const BASE = (import.meta?.env?.BASE_URL ?? '/');
    const isIOS =
      (window.Capacitor && typeof window.Capacitor.getPlatform === 'function' && window.Capacitor.getPlatform() === 'ios') ||
      /iPad|iPhone|iPod/.test(navigator.userAgent);
    const reduceMotion = window.matchMedia?.('(prefers-reduced-motion: reduce)')?.matches;

    if (!isIOS || reduceMotion) { /* no-op */ } else {
      const overlay = document.createElement('div');
      overlay.setAttribute('data-ios-intro', 'true');
      Object.assign(overlay.style, {
        position: 'fixed', inset: '0', zIndex: '2147483647',
        backgroundColor: '#000', display: 'flex',
        alignItems: 'center', justifyContent: 'center',
        backgroundImage: `url("${BASE}branding/splash.png")`,
        backgroundRepeat: 'no-repeat', backgroundPosition: 'center center',
        backgroundSize: 'cover'
      });

      const video = document.createElement('video');
      video.setAttribute('playsinline', '');
      video.setAttribute('webkit-playsinline', '');
      video.setAttribute('muted', '');
      video.setAttribute('autoplay', '');
      video.setAttribute('preload', 'auto');
      video.setAttribute('aria-label', 'Intro');
      Object.assign(video.style, { maxWidth: '100%', maxHeight: '100%', objectFit: 'cover' });
      video.src = `${BASE}videos/intro.mp4`;

      const cleanup = () => {
        overlay.style.transition = 'opacity 220ms ease-out';
        overlay.style.opacity = '0';
        setTimeout(() => overlay.remove(), 240);
      };

      const failSafe = setTimeout(cleanup, 6500);
      video.addEventListener('ended', () => { clearTimeout(failSafe); cleanup(); });
      video.addEventListener('error', () => { clearTimeout(failSafe); cleanup(); });
      video.addEventListener('abort', () => { clearTimeout(failSafe); cleanup(); });

      document.addEventListener('DOMContentLoaded', () => {
        document.body.appendChild(overlay);
        setTimeout(() => {
          overlay.appendChild(video);
          const p = video.play?.();
          if (p && p.catch) p.catch(() => {});
        }, 60);
      });
    }
  </script>
  </body>
</html>
