<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VitaCard 365 - Feature Graphic 1024x500</title>
  <style>
    :root { --w: 1024; --h: 500; }
    html, body { margin: 0; padding: 0; background: #0b1626; color: #e7e7ea; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji'; }
    .wrap { max-width: 1080px; margin: 24px auto; padding: 16px; }
    .row { display: flex; gap: 12px; align-items: center; }
    canvas { border-radius: 8px; box-shadow: 0 8px 40px rgba(0,0,0,.35); width: 100%; height: auto; max-width: 1024px; }
    button { background: #0AD6D6; color: #0b1626; font-weight: 700; border: 0; border-radius: 10px; padding: 10px 14px; cursor: pointer; }
    small { opacity: .75; }
    .hint { margin-top: 8px; font-size: 12px; opacity: .8; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="row" style="justify-content: space-between;">
      <h3 style="margin: 0;">Generador de Feature Graphic (1024x500)</h3>
      <div class="row">
        <label class="row" style="gap:6px; align-items:center">
          <small>Icono (opcional):</small>
          <input id="iconFile" type="file" accept="image/*" />
        </label>
        <label class="row" style="gap:6px; align-items:center">
          <small>Screenshot/UI (opcional):</small>
          <input id="uiFile" type="file" accept="image/*" />
        </label>
        <button id="btnDownload">Descargar PNG</button>
      </div>
    </div>
    <div class="hint">Por defecto intenta cargar ../icon.png. Podés reemplazarlo con el selector. El screenshot/UI es opcional (se ubica a la derecha con bordes redondeados).</div>
    <canvas id="c" width="1024" height="500"></canvas>
  </div>

  <script>
    const W = 1024, H = 500;
    const c = document.getElementById('c');
    const ctx = c.getContext('2d');
    let customIcon = null;
    let customUI = null;

    function drawBackground() {
      // Degradado diagonal
      const g = ctx.createLinearGradient(0, 0, W, H);
      g.addColorStop(0, '#0b1626');
      g.addColorStop(1, '#0ad6d64d');
      ctx.fillStyle = g;
      ctx.fillRect(0, 0, W, H);

      // Safe area overlay (opcional, invisible)
      // ctx.strokeStyle = 'rgba(255,255,255,.15)';
      // ctx.lineWidth = 2; ctx.strokeRect(60, 60, W-120, H-120);
    }

    function drawText() {
      const title = 'VitaCard 365';
      const subtitle = 'Entrenamiento y salud en un solo lugar';
      const bullets = ['Rutinas', 'Running + pulso BLE', 'Recordatorios'];

      ctx.fillStyle = '#e7e7ea';
      ctx.font = '700 56px system-ui, Segoe UI, Roboto, Arial';
      ctx.fillText(title, 420, 190);

      ctx.globalAlpha = 0.9;
      ctx.font = '600 28px system-ui, Segoe UI, Roboto, Arial';
      ctx.fillText(subtitle, 420, 235);
      ctx.globalAlpha = 1;

      ctx.font = '500 24px system-ui, Segoe UI, Roboto, Arial';
      let y = 280;
      for (const b of bullets) {
        ctx.fillStyle = '#0AD6D6';
        ctx.beginPath(); ctx.arc(420, y-10, 5, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = '#e7e7ea';
        ctx.fillText(b, 440, y);
        y += 38;
      }
    }

    function drawIcon(img) {
      const size = 320; // alto aprox. del icono
      const x = 60, y = (H - size) / 2;
      // Sombra suave
      ctx.save();
      ctx.shadowColor = 'rgba(0,0,0,.4)';
      ctx.shadowBlur = 30; ctx.shadowOffsetY = 6;
      ctx.drawImage(img, x, y, size, size);
      ctx.restore();
    }

    function roundRectPath(x, y, w, h, r) {
      const rr = Math.min(r, w/2, h/2);
      ctx.beginPath();
      ctx.moveTo(x + rr, y);
      ctx.arcTo(x + w, y, x + w, y + h, rr);
      ctx.arcTo(x + w, y + h, x, y + h, rr);
      ctx.arcTo(x, y + h, x, y, rr);
      ctx.arcTo(x, y, x + w, y, rr);
      ctx.closePath();
    }

    function drawUI(img) {
      // Área derecha reservada para UI
      const box = { x: 700, y: 90, w: 280, h: 320, r: 26 };
      // Ajustar imagen dentro del box manteniendo proporción
      const ratio = Math.min(box.w / img.width, box.h / img.height);
      const dw = img.width * ratio;
      const dh = img.height * ratio;
      const dx = box.x + (box.w - dw) / 2;
      const dy = box.y + (box.h - dh) / 2;

      // Sombra + clip redondeado
      ctx.save();
      ctx.shadowColor = 'rgba(0,0,0,.35)';
      ctx.shadowBlur = 24; ctx.shadowOffsetY = 8;
      roundRectPath(box.x, box.y, box.w, box.h, box.r);
      ctx.clip();
      ctx.drawImage(img, dx, dy, dw, dh);
      ctx.restore();

      // Marco sutil
      ctx.save();
      ctx.strokeStyle = 'rgba(255,255,255,.15)';
      ctx.lineWidth = 2;
      roundRectPath(box.x, box.y, box.w, box.h, box.r);
      ctx.stroke();
      ctx.restore();
    }

    async function loadDefaultIcon() {
      return new Promise((resolve) => {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        img.onload = () => resolve(img);
        img.onerror = () => resolve(null);
        img.src = '../icon.png';
      });
    }

    async function render(customIconImg, customUiImg) {
      // Limpiar
      ctx.clearRect(0, 0, W, H);
      drawBackground();
      const iconImg = customIconImg ?? customIcon ?? await loadDefaultIcon();
      if (iconImg) drawIcon(iconImg);
      if (customUiImg || customUI) drawUI(customUiImg || customUI);
      drawText();
    }

    document.getElementById('iconFile').addEventListener('change', (ev) => {
      const file = ev.target.files?.[0];
      if (!file) return;
      const fr = new FileReader();
      fr.onload = () => {
        const img = new Image();
        img.onload = () => { customIcon = img; render(customIcon, customUI); };
        img.src = fr.result;
      };
      fr.readAsDataURL(file);
    });

    document.getElementById('uiFile').addEventListener('change', (ev) => {
      const file = ev.target.files?.[0];
      if (!file) return;
      const fr = new FileReader();
      fr.onload = () => {
        const img = new Image();
        img.onload = () => { customUI = img; render(customIcon, customUI); };
        img.src = fr.result;
      };
      fr.readAsDataURL(file);
    });

    document.getElementById('btnDownload').addEventListener('click', () => {
      const url = c.toDataURL('image/png');
      const a = document.createElement('a');
      a.href = url; a.download = 'feature-graphic-1024x500.png';
      a.click();
    });

    render();
  </script>
</body>
</html>
